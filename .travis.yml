sudo: required
services:
  - docker
before_install:
  - docker version
script:
  - TAG=$(git describe --tags)
  - docker build -t dtr.getdropstream.com/$DOCKER_USER/service_with_hooks:$TAG .
  - docker tag dtr.getdropstream.com/$DOCKER_USER/service_with_hooks:$TAG dtr.getdropstream.com/$DOCKER_USER/service_with_hooks:latest
  - docker login dtr.getdropstream.com -u $DOCKER_USER -p $DOCKER_PASSWORD
  - docker push dtr.getdropstream.com/$DOCKER_USER/service_with_hooks:$TAG
  - docker push dtr.getdropstream.com/$DOCKER_USER/service_with_hooks:latest
env:
  global:
  # DOCKER_USER
  - secure: "rkjKJqNrFq916LVCdZVOerEuueM+jo2DX+x4MrtLyNGB5fKSbmsO84DmdCXSVU/2yFAh1m6Bdryc/DRbOAa7gMdRJp2o2E0MEgYDYyzGAJu42Z6zoqQOalKYoneAey7ohcvbbsjJbX780AMTwuKqiT/ULgkxVGjrGVsM3A2jhcxWXy9SDVNhQE5JG42ivjdcg48F/afN2gBYM1+d7ZBygtRufeNPIbuwPOnuw+/r3pAd/kmbH74/HYb+8c+ze4kc5pGCLeu6JdrXZwWfwXCzdO0byYDSi/02jqu4232tBnao9nFhJnY3DmmpbLMVkRFdWfJLTWaHOL+LXSWI+XY3sz5y7Zn0qyiH8PnIiQ0yvQiDRXbCv3v2c+hkRVz9Mbujdm4Rs1f52SAob1OhQs+qrmLEKwjntsJojlaI+tDP+lNf+1DLdzC0inLNw+vPkWV5/E52/AUoqYGbAJ03hpWnjG/vBWkivHeJvU4jXEDtYlikll9gOE5EhRoUeyVFH8i+Kk6qKeBP/i55feLjPSEhDif+2/lOPwN7zYExfFs/gT+DmDSOS5KQlYjDhal8D8njTuie5bdul4ImL4vVSQHbBPJjxUS0sref1xqoW6xoyVlQ+LKOWG0yATqK13K8zCHgi1Vu7f1z6AGAup6xSHjVPGUbQViKX4BD8IOi/CxJtas="
  # DOCKER_PASSWORD
  - secure: "UC9tu+aC9XTmQXzFzcvdmhMfsSOn0vOTJVBd0BzjUQp1SxPQuojeRZm7wJAASf58EwjHuXtXEjE6fpatgRT+hwR1WlRq2rFAqHmA90mMUudNnth2qsJjrSQ/EQCIeTWFXlCmF8MdwxSn9Bn/4fdcYNhUxB1L/TnHXv4jEgQMCwNQMKuxDxpTIX9JK6dIK8Aw4x94GzoFut9jvbjs6PhTL6cUM/NP8I32k5ucZVmHaMASxyWUV58EFjKtORLvJfEbY0xJFlKm3w33YnuFvk/FrL57qRm2yRCi6yNq4f9BwzpdCgfUM883QlWY+fxaRCVOH4Ul8T4Iw+mQpazLPFAWOk+dm9OXSHTz9gKy+E+G4qVny6RpVmblrdBKrbkrRxJYhcRaRkO4HrT/jtOjnlilWkLtxp6gezx9H9rKRTVFN9QnWH+zzTPq1cKua+3hDH0gjZzI9nPrSQPEBHOwrlD6BrEJybSw1ZFYe3p7M3C1weLP5smDiCTnlapVs6O4R5np/xUrqNuPZ0Iwifj+J8KEvtoIo7vztiLdzHEks8mr/4REUI0uJcj13y6vG+fMpuUjVWcYsNgvLqaU13rf/SBSmF50NLw2Bfsx4V6cooQAl6G0SoUdgRuyctfxJib21mIqi3tKuAVVOnHQtoOcU1FF6TPejy4fKyaYTb3unfKWurY="
  # GEM_PASSWORD
  - secure: "XvpGc4qQSJ1U3mtjjqil+i60ss+o0TGxVRVqxAYzssjmqOjHOk3UyGhYmhFqvZlLb5eLlSQwRItYejuesUY0bFbPSphzZNNiewJUoDbJ4yRphGjM9krGNzohvzi8Oqi21A8V8sb7kxJxiMLxnfTN7ntiXAddgbIy8aA9m1JiYBPujA1YhAR/SNtiMIPFOqYr6t7050RGDG3/bKkV9fAxYxFQGXOQtzhS6CFjjlygyjq+UzIIGjmsGEJGHymlxJuszTne6usKVzS9VYGDFMI9TTqhIH1avChOtI4eZHO4O0WCs0J6fCPWkcl5tzK6vNZwQujTSOwXM9B3NCKQoQvqWCiRISRgoR/m+eHKTwaQAWO7nJJvm4ptwdzJzq9vd0QMLzgTl5Ep6JxPNdfKcl0T8xN5Zflqw081mt35jVip4IevG5UBH6HrwhxSgFMRA1FGYIugb4f4wuIFMjBgBBaP1RLPfyb2RWNnvOi0U0y79jP2seVc1UbDso2bva5d7B2z2AgwrpAlfrzAM6SRSKMt7V8BUw/UOoaemVGLFeTAUmeK18xIzZdZ+Ra8BZw5OE235x6TZ/r9ZSCWN/rshkQPnVmk27bYLRuqLTqKKQxbbpJbeQEYCCzx/roDfDIVZ3p266Kd8xX43YgSprJgHOMtFfjdrvcZWH3rJQNMPffjPZU="
